{%- import "_macros/utils.twig" as utils -%}
{%- import "_macros/ui.twig" as ui -%}

{# Set color classes from block settings #}
{%- set backgroundColour = block.backgroundColour.color[0].background -%}
{%- set headingColour = block.headingColour.color[0].heading -%}
{%- set textColour = block.textColour.color[0].text -%}

{# Get solicitor profile data #}
{%- set solicitorEntry = block.teamMember.one() -%}

<section class="solicitor-profile content-block
  {{ headingColour }}
  {{ textColour }}
  {{ backgroundColour }}
  "
  {{ utils.debugAttributes(entry, block.type, 'Solicitor Profile') }}
  >
  <div class="content-block-inner container-medium">
    {% if solicitorEntry %}
      <div class="solicitor-profile-wrapper">
        
        {# Profile Image #}
        <div class="profile-image-wrapper">
          {% if solicitorEntry.headshot.one() %}
            {{ ui.component('image', {
              img: solicitorEntry.headshot.one(),
              class: 'profile-image',
              sizes: '(max-width: 767px) 200px, 300px',
              formats: ['webp'],
              alt: solicitorEntry.firstName ~ ' ' ~ solicitorEntry.lastName ~ ' profile photo',
              lazy: true,
              responsive: {
                sm: { mode: 'crop', width: 200, height: 200, quality: 90, position: 'center-center' },
                md: { mode: 'crop', width: 300, height: 300, quality: 90, position: 'center-center' },
              }
            }) }}
          {% endif %}
        </div>

        {# Profile Content #}
        <div class="profile-content">
          
          {# Name and Title #}
          <div class="profile-header">
            {% if solicitorEntry.firstName or solicitorEntry.lastName %}
              <h2 class="solicitor-name">
                {{ solicitorEntry.firstName }} {{ solicitorEntry.lastName }}
              </h2>
            {% endif %}
            
            {% if solicitorEntry.jobTitle %}
              <p class="solicitor-title">{{ solicitorEntry.jobTitle }}</p>
            {% endif %}
          </div>

          {# Bio Content #}
          {% if solicitorEntry.bio %}
            <div class="solicitor-bio">
              {{ ui.component('rich-text', { 
                content: solicitorEntry.bio 
              }) }}
            </div>
          {% endif %}

          {# Contact Information #}
          <div class="contact-info">
            {% if solicitorEntry.telephone %}
              <div class="contact-item contact-phone">
                <svg class="contact-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z"/>
                </svg>
                <a href="tel:{{ solicitorEntry.telephone }}" class="contact-link">
                  {{ solicitorEntry.telephone }}
                </a>
              </div>
            {% endif %}

            {% if solicitorEntry.email %}
              <div class="contact-item contact-email">
                <svg class="contact-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"/>
                </svg>
                <a href="mailto:{{ solicitorEntry.email }}" class="contact-link">
                  {{ solicitorEntry.email }}
                </a>
              </div>
            {% endif %}

            {% if solicitorEntry.linkedIn %}
              <div class="contact-item contact-linkedin">
                <svg class="contact-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M19,3A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3H19M18.5,18.5V13.2A3.26,3.26 0 0,0 15.24,9.94C14.39,9.94 13.4,10.46 12.92,11.24V10.13H10.13V18.5H12.92V13.57C12.92,12.8 13.54,12.17 14.31,12.17A1.4,1.4 0 0,1 15.71,13.57V18.5H18.5M6.88,8.56A1.68,1.68 0 0,0 8.56,6.88C8.56,5.95 7.81,5.19 6.88,5.19A1.69,1.69 0 0,0 5.19,6.88C5.19,7.81 5.95,8.56 6.88,8.56M8.27,18.5V10.13H5.5V18.5H8.27Z"/>
                </svg>
                {% if solicitorEntry.linkedIn starts with 'http' %}
                  <a href="{{ solicitorEntry.linkedIn }}" class="contact-link" target="_blank" rel="noopener">
                    {{ solicitorEntry.linkedIn|replace({'https://www.linkedin.com/in/': '#', 'https://linkedin.com/in/': '#'}) }}
                  </a>
                {% else %}
                  <span class="contact-link">
                    #{{ solicitorEntry.linkedIn }}
                  </span>
                {% endif %}
              </div>
            {% endif %}
          </div>

        </div> {# .profile-content #}
      </div> {# .solicitor-profile-wrapper #}
    {% endif %}
  </div> {# .content-block-inner #}
</section>